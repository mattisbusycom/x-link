/**
 * x-link - 0.1.0
 *
 * Web Component for caching CSS in the local storage.
 *
 * http://www.emanuel-kluge.de
 *
 * Copyright (c) 2014 Emanuel Kluge;
 * Licensed MIT
 */
!function(){function a(){var a=this,b=a.getAttribute("data-href"),f=JSON.parse(localStorage.getItem(b));g(b,function(g){var h=e(g.getAllResponseHeaders());return!f||h["Last-Modified"].getTime()>f["Last-Modified"]||h["Content-Length"]!=f["Content-Length"]?void d(b,function(b){c(a,b)}):void c(a,f.content)})}function b(){xtag.fireEvent(this,"ready")}function c(a,b){var c=document.createElement("style");c.type="text/css",c.textContent=b,a.parentNode.replaceChild(c,a)}function d(a,b){h(a,function(c){var d=e(c.getAllResponseHeaders()),f=c.responseText.replace(/(\r\n|\t+?)/g,"");localStorage.setItem(a,JSON.stringify({"Content-Type":d["Content-Type"],"Content-Length":d["Content-Length"],"Last-Modified":d["Last-Modified"].getTime(),content:f})),b(f)})}function e(a){var b=a.split(/\r\n/),c={};return b.forEach(function(a){var b=a.split(": ");if(b[0])return"Date"===b[0]||"Last-Modified"===b[0]?void(c[b[0]]=new Date(b[1])):void(c[b[0]]=b[1])}),c}function f(a,b,c,d){var e=new XMLHttpRequest,d=d||"DONE";e.open(a,b),e.onreadystatechange=function(){this.readyState==this[d]&&c.call(null,this)},e.send()}function g(a,b){f("HEAD",a,b,"HEADERS_RECEIVED")}function h(a,b){f("GET",a,b)}xtag.register("x-link",{"extends":"link",lifecycle:{created:a,removed:b}})}();